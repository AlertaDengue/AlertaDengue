<div id="date-chart" class="chart-default"></div>
<script type="application/javascript">
var date_chart;

$(document).ready(function () {
    // Create the chart
    date_chart = Highcharts.stockChart('date-chart', {
        chart: {
            type: 'line',
            spacingBottom: 0,
            spacingTop: 0,
            spacingLeft: 0,
            spacingRight: 0,

            events: {
                selection: function(event) {
                    console.log(
                        Highcharts.dateFormat('%Y-%m-%d %H:%M:%S', event.xAxis[0].min),
                        Highcharts.dateFormat('%Y-%m-%d %H:%M:%S', event.xAxis[0].max)
                    );
                }
            },
        },
        data: {
            csv: `{{date_dist}}`
        },
        rangeSelector: {
            enabled: false
        },
        xAxis: {

        },
        title: {
            text: ''
        },
        subtitle: {
            text: 'IncidÃªncia Semanal'
        },
        yAxis: {
            min: 0,
            title: {
                text: 'Casos'
            }
        },
        legend: {
            enabled: false
        },
        credits: {
            enabled: false
        },
        tooltip: {
            shared: true
        }
    });

    var start = $('#initial_date').val().replace(/-/g, '.');
    var end = $('#final_date').val().replace(/-/g, '.');

    if (start != '' && end != '') {
        date_chart.xAxis[0].setExtremes(
            Date.parse(start), Date.parse(end)
        );
    }
});

function sendPeriodSelected() {
    var extremes = date_chart.xAxis[0].getExtremes(),
        start = new Date(extremes.min),
        end   = new Date(extremes.max);

    $('#initial_date').val(Highcharts.dateFormat('%Y-%m-%d', start));
    $('#final_date').val(Highcharts.dateFormat('%Y-%m-%d', end));
    $('#formFilters').submit();
}

</script>
